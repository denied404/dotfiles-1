#!/bin/bash

:stop() {
    echo ":: sending user-defined signal to redshift"
    pkill -TERM -f /bin/redshift
    exit 0
}

:is-running() {
    pidof /bin/redshift &>/dev/null
}

:start() {
    echo ":: starting new redshift instance"
    /bin/redshift -O 4500K &
}

op="$1"
if [[ "$op" == "toggle" ]]; then
    if :is-running; then
        :stop
    else
        :start
    fi

    exit 0
fi

if [[ "$op" == "start" ]]; then
    if ! :is-running; then
        :start
    fi

    exit 0
fi

if [[ "$op" == "stop" ]]; then
    if :is-running; then
        :stop
    fi

    exit 0
fi

echo "unexpected op: $op" >&2
exit 1
