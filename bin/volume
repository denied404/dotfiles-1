#!/bin/bash

[ -n "$_LOCK" ] || _LOCK=x exec flock -n $0 $0 "$@"

:main() {
    local action=$1

    local status="$(:change "$action")"

    if [[ -f /tmp/volume.value ]]; then
        prev=$(cat /tmp/volume.value)
        if [[ "$prev" == "$status" ]]; then
            pkill -9 volume
            exit 0
        fi
    fi

    :notify "$status"
    echo "$status" > /tmp/volume.value
}

:notify() {
    local value=$1
    notify-send.sh -r 300 -t 100 " " -- "<b>VOLUME</b>   ${value}%"
}

:change() {
    local action=$1

    case $action in
        up)
            ponymix increase 2
        ;;

        down)
            ponymix decrease 2
        ;;
    esac
}


:main "${@}"
