#!/bin/sudo /bin/bash
# CAUTION! bash executes with boss privileges!

case "$1" in
    "google" )
        echo "nameserver 8.8.8.8" > /etc/resolv.conf
        ;;
    "office" )
        {
            echo "nameserver 192.168.20.2"
            echo "nameserver 192.168.21.100"
            echo "search cname.s in.ngs.ru"
        } > /etc/resolv.conf

        if ip a | grep -q ppp0; then
            ip r a 192.168.160.0/24 dev ppp0
            ip r a 192.168.80/24 dev ppp0
            ip r a 192.168.44.0/24 dev ppp0
            ip r a 192.168.23.0/24 dev ppp0
            ip r a 192.168.22.0/24 dev ppp0
            ip r a 192.168.21.0/24 dev ppp0
            ip r a 192.168.20.0/24 dev ppp0
            ip r a 192.168.2.0/24 dev ppp0
            ip r a 192.168.4.0/24 dev ppp0
            ip r a 192.168.5.0/24 dev ppp0
            ip r a 172.28.0.0/16 dev ppp0
            ip r a 172.16.0.0/16 dev ppp0
        fi
        ;;
    "local" )
        resolvconf -u
        ;;
    \?)
        echo "Usage:"
        echo "  resolv-switch (local | office | google)"
        exit 1
        ;;
esac
